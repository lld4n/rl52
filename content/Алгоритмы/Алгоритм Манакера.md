---
title: Алгоритм Манакера
date: 2023-11-03
---
#палиндром #подстрока #строка

## Пояснения
**Алгоритм Манакера** - алгоритм с **линейным** временем работы, позволяющий получить в сжатом виде информацию обо всех палиндромных подстроках заданной строки. Алгоритм схож с [[Z-функция]] и [[Префикс-функция]]

Нам нужно получить массив `dp1` (длина массива равна длине строки), где в каждой `dp1[i]` хранится количество нечетных палиндромом в центре `i`

Суть в том, что мы работаем динамически, сохраняя значения для каждой вычисленной точки `dp1[i]`, а также храним информацию о палиндроме который находится над проверяемой точкой. Это позволяет нам утверждать, что существует схожий по отношению к нам палиндром, который находится левее нашего `i`

## Код
Для нечетных палиндромов код выглядит так
```js
const d1 = new Array(n);
let left = 0, right = -1;
for (let i = 0; i < n; ++i) {
  const k = i > right ? 1 : Math.min(d1[left + right - i], right - i + 1);
  while (i + k < n && i - k >= 0 && s[i + k] === s[i - k])  ++k;
  d1[i] = k;
  if (i + k - 1 > right) {
    left = i - k + 1;
    right = i + k - 1;
  }
}
```

Для четных выглядит так
```js
const d2 = new Array(n).fill(0);  
let left = 0,  
  right = -1;  
for (let i = 0; i < n; ++i) {  
  let k = i > right ? 0 : Math.min(d2[left + right - i + 1], right - i + 1);  
  while (i + k < n && i - k - 1 >= 0 && str[i + k] === str[i - k - 1]) {  
    ++k;  
  }  
  d2[i] = k;  
  if (i + k - 1 > right) {  
    left = i - k;  
    right = i + k - 1;  
  }  
}
```

